/* Prevel Framework v1.0.0
 * http://github.com/chernikovalexey/Prevel
 * 
 * Copyright 2011, Alexey Chernikov
 * Dual licensed under the:
 *  - GNU LGPL (http://opensource.org/licenses/lgpl-license.php)
 *  - MIT License (http://opensource.org/licenses/mit-license.php)
 * 
 * =====
 * 
 * Contains YASS v0.3.9
 * http://yass.webo.in
 * 
 * Copyright 2008-2009, Nikolay Matsievsky (sunnybear)
 * Dual licensed under the:
 *  - MIT License (http://opensource.org/licenses/mit-license.php)
 *  - GNU GPL (http://opensource.org/licenses/gpl-license.php)
**/
(function(win,doc,proto,ael,ge,cn,nn,u,newRegExp,n,ef,uf){(function(){var types={"function":"fn",object:"obj",number:"int",string:"str","boolean":"bool","undefined":u},accessors=!!Object[proto].__lookupGetter__&&!!Object[proto].__lookupSetter__,pl=function(){return function(a,b,c){return pl.fn?new pl.fn.init(a,b,c):uf}}(),ua=win.navigator.userAgent.toLowerCase();pl.extend=function(a,b){b||(b=a,a=pl);if(accessors){var c,d;for(var e in b)c=b.__lookupGetter__(e),d=b.__lookupSetter__(e),c||d?(c&&a.__defineGetter__(e,c),d&&a.__defineSetter__(e,d)):a[e]||(a[e]=b[e])}else for(var e in b)a[e]||(a[e]=b[e]);return a},pl.extend({implement:function(a,b){return pl.extend(a[proto],b)},isArray:Array.isArray||function(a){return Object[proto].toString.call(a)==="[object Array]"},type:function(a,b){var c;return pl.isArray(a)?c="arr":a instanceof RegExp?c="regexp":a instanceof Date?c="date":a===n?c=nn:c=types[typeof a],b?c===b:c},empty:function(a){if(pl.type(a,"obj")){for(var b in a)return!1;return!0}return pl.type(a,nn)||pl.type(a,u)||!a.length},trim:function(a){return String[proto].trim?a.trim():a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},each:function(a,b){var c=a.length;while(--c>-1)b.call(a[c],c,a[c])},inArray:function(a,b){return Array[proto].indexOf?b.indexOf(a):(pl.each(b,function(b){if(a===this)return b}),-1)},toParams:function(a){if(!pl.type(a,"obj"))return a;var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},JSON:function(data){return!/[^,:{}[]0-9.-+Eaeflnr-u nrt]/.test(data.replace(/"(.|[^"])*"/g,""))&&eval("("+data+")")},browser:function(a){var b=/opera/i.test(ua),c=/chrome/i.test(ua),d={opera:b,ie:!b&&/msie/i.test(ua),ie6:!b&&/msie 6/i.test(ua),ie7:!b&&/msie 7/i.test(ua),ie8:!b&&/msie 8/i.test(ua),firefox:/firefox/i.test(ua),chrome:c,safari_khtml:!c&&/khtml/i.test(ua),safari:!c&&/webkit|safari/i.test(ua)};for(var e in d)if(d[e])return a===e||e}}),pl.extend(win,{pl:pl,prevel:pl})})(),function(){pl.extend({ajax:function(a){var b,c=a.load||ef,d=a.error||ef,e=a.success||ef,f=function(){if(win.XMLHttpRequest)b=new XMLHttpRequest,b.overrideMimeType&&b.overrideMimeType("text/html");else if(win.ActiveXObject)try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){}}if(!b)return alert("Could not create an XMLHttpRequest instance.");b.onreadystatechange=function(f){switch(b.readyState){case 1:c();break;case 4:b.status===200?e(a.dataType==="json"?pl.JSON(b.responseText):b.responseText):d(b.status)}}},g=function(c){b.setRequestHeader("X-Requested-With","XMLHttpRequest"),c&&b.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset="+(a.charset||"utf-8"))};a.type=a.type||"POST",a.data=pl.toParams(a.data||{}),a.async=a.async||!0,f();switch(a.type){case"POST":b.open("POST",a.url,a.async),g(1),b.send(a.data);break;case"GET":b.open("GET",a.url+"?"+a.data,a.async),g(),b.send(n)}}})}(),function(){var a={className:"class",cssFloat:"float",htmlFor:"for"};pl.extend({fn:{}}),pl.extend(pl.fn,{find:function(a,b){return doc.querySelectorAll(b?b+" "+a:a)},init:function(){return function(a,b,d){var f;switch(pl.type(a)){case"str":var g=a.match(newRegExp);if(g)f=[e(g[1],b)];else switch(pl.type(b)){case"str":switch(pl.type(d)){case"int":f=[pl.find(a,b)[d]];break;default:case u:f=pl.find(a)}break;case"int":f=[pl.find(a)[b]];break;default:case u:f=pl.find(a)}break;case"fn":c.ready(a);break;case"obj":f=[a]}return this.elements=f,this.selector=arguments,__this=this,this}}(),len:function(){return this.elements.length},last:function(){var a=this.elements.length;return this.elements=[a?this.elements[a-1]:n],this},html:function(a,b){return d(this,"innerHTML",a,b)},text:function(a,c){return d(this,b,a,c)},get:function(a){var b=this.elements;return b.length===1?b[0]:pl.type(a,u)?b:b[a]},parent:function(a){if(!a)var a=1;return g(this.elements[0],a)},remove:function(){return pl.each(this.elements,function(){this.parentNode.removeChild(this)}),this},addClass:function(a){return pl.each(this.elements,function(){if(pl.inArray(a,this[cn].split(" "))!==-1)return;this[cn]+=(this[cn]?" ":"")+a}),this},hasClass:function(a){return pl.inArray(a,this.elements[0][cn].split(" "))!==-1},removeClass:function(a){return pl.each(this.elements,function(){var b=this[cn].split(" "),c=pl.inArray(a,b);if(c===-1)return;b.splice(c,1),pl.empty(b)?this.removeAttribute("class"):this[cn]=b.join(" ")}),this},attr:function(b,c){b=a[b]||b;if(c)pl.each(this.elements,function(){this.setAttribute(b,c)});else switch(pl.type(b)){case"obj":for(var d in b)arguments.callee.call(this,d,b[d]);break;case"str":return this.elements[0].getAttribute(b)}return this},removeAttr:function(b){return b=a[b]||b,pl.each(this.elements,function(){this.removeAttribute(b)}),this},css:function(a,b){if(b){a=f.fixStyle(a);if(pl.type(b,"int")&&!f.rmvPostFix[a])b+="px";else if(a==="opacity")var c=f.fixOpacity(b),a=c[0],b=c[1];pl.each(this.elements,function(){this.style[a]=b})}else switch(pl.type(a)){case"obj":for(var d in a)arguments.callee.call(this,d,a[d]);break;case"str":return f.get(this.elements[0],a)}return this},each:function(a){return pl.each(__this.elements,function(){a.call(this)}),this},bind:function(a,b){return c.routeEvent(a,b,1)},unbind:function(a,b){return c.routeEvent(a,b,0)},show:function(){return pl.each(this.elements,function(){if(pl(this).css("display")!=="none")return;pl(this).css("display",this.getAttribute("plrd")||"")}),this},hide:function(){return pl.each(this.elements,function(){var a=pl(this).css("display");if(a==="none")return;this.setAttribute("plrd",a),this.style.display="none"}),this},after:function(a){if(pl.type(a,"obj")){var b=doc.createElement("div");b.appendChild(a),a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=doc.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.parentNode.insertBefore(this,b.nextSibling)})}catch(d){}}),this},before:function(a){if(pl.type(a,"obj")){var b=doc.createElement("div");b.appendChild(a),a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=doc.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.parentNode.insertBefore(this,b)})}catch(d){}}),this},append:function(a){if(pl.type(a,"obj")){var b=doc.createElement("div");b.appendChild(a),a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=doc.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.appendChild(this)})}catch(d){}}),this},prepend:function(a){if(pl.type(a,"obj")){var b=doc.createElement("div");b.appendChild(a),a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=doc.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.insertBefore(this,b.firstChild)})}catch(d){}}),this}}),pl.implement(pl.fn.init,pl.fn);var b=pl.browser("ie")?"innerText":"textContent",c={ready:function(){this.readyList=[],this.bindReady=function(a){function d(){if(b)return;b=!0,a()}var b=!1;if(doc[ael])c.attaches.bind(doc,"DOMContentLoaded",d);else if(doc.attachEvent){if(doc.documentElement.doScroll&&win===win.top){function e(){if(b)return;if(!doc.body)return;try{doc.documentElement.doScroll("left"),d()}catch(a){setTimeout(e,0)}}e()}c.attaches.bind(doc,"readystatechange",function(){doc.readyState==="complete"&&d()})}c.attaches.bind(win,"load",d)};var a=this;return function(b){a.readyList.length||a.bindReady(function(){pl.each(a.readyList,function(a){this()})}),a.readyList.push(b)}}(),attaches:function(){function b(a){return a=a||win.event,a.fixed?a:(a.fixed=!0,a.preventDefault=a.preventDefault||function(){this.returnValue=!1},a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=!0},a.target||(a.target=a.srcElement),!a.which&&a.button&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0),a)}function d(a){a=b(a);var c=this.evt[a.type];for(var d in c){var e=c[d].call(this,a);e||(a.preventDefault(),a.stopPropagation())}}var a=0;return{bind:function(b,e,f){pl.browser("ie")&&b.setInterval&&b!==win&&(b=win),f.turnID||(f.turnID=++a),b.evt||(b.evt={},b.handleEvt=function(a){if(!pl.type(c.attaches,u))return d.call(b,a)}),b.evt[e]||(b.evt[e]={},b[ael]?b[ael](e,b.handleEvt,!1):b.attachEvent("on"+e,b.handleEvt)),b.evt[e][f.turnID]=f},unbind:function(a,b,c){var d=a.evt&&a.evt[b];if(!d)return;delete d[c.turnID];for(var e in d)return;a.removeEventListener?a.removeEventListener(b,a.handleEvt,!1):a.detachEvent("on"+b,a.handleEvt),delete a.evt[b];for(var e in a.evt)return;try{delete a.handleEvt,delete a.evt}catch(f){a.removeAttribute("handleEvt"),a.removeAttribute("evt")}}}}(),routeEvent:function(a,b,d){if(b)d?pl.each(__this.elements,function(){c.attaches.bind(this,a,b)}):pl.each(__this.elements,function(){c.attaches.unbind(this,a,b)});else for(var e in a)arguments.callee(e,a[e],d);return __this}},d=function(a,b,c,d){var e=a,a=e.elements[0];if(!c)return a[b];if(!d)a[b]=c;else switch(d){case 1:pl.each(e.elements,function(){this[b]+=c});break;case-1:pl.each(e.elements,function(){this[b]=c+this[b]})}return e},e=function(a,b){var c=doc.createElement(a);return b?pl.extend(c,b):c},f={fixStyle:function(a){if(!a.match("-"))return a;var b=a.split("-");return b[0]+b[1].toUpperCase()},fixOpacity:function(a){var b="opacity",c=[b,a];switch(pl.browser()){case"ie7":c[0]="filter",c[1]="alpha("+b+"="+a*100+");";break;case"ie8":c[0]="-ms-filter",c[1]="alpha("+b+"="+a*100+")";break;case"safari_khtml":c[0]="-khtml-"+b;break;case"firefox":c[0]="-moz-"+b}return c},fixReturnOpacity:function(a){return a?a.match("opacity=")?a.match("=([0-9]+)")[1]/100:a:n},rmvPostFix:{zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0},get:function(a,b){if(b==="opacity")var c=f.fixOpacity(0),b=c[0];return f.fixReturnOpacity(a.currentStyle?a.currentStyle[b]:win.getComputedStyle(a,n).getPropertyValue(b))}},g=function(a,b){return b>0?g(a.parentNode,--b):a}}(),function(){var a=!!doc[ge+"sByClassName"],b=!!doc.querySelectorAll;pl.extend({find:function(c){return pl.extend(c,{attr:{"":function(a,b){return!!a.getAttribute(b)},"=":function(a,b,c){return(b=a.getAttribute(b))&&b===c},"&=":function(a,b,c){return},"^=":function(a,b,c){return},"$=":function(a,b,c){return},"*=":function(a,b,c){return},"|=":function(a,b,c){return},"!=":function(a,b,c){return}},mods:{"first-child":function(a){return a.parentNode[ge+"sByTagName"]("*")[0]!==a},"last-child":function(a){var b=a;while((b=b.nextSibling)&&b.nodeType!=1);return!!b},root:function(a){return a.nodeName.toLowerCase()!=="html"},"nth-child":function(a,b){var c=a.nodeIndex||0,d=b[3]=b[3]?(b[2]==="%"?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.firstChild;c++;do if(f.nodeType==1&&(f.nodeIndex=++c)&&a===f&&(c+d)%e)return 0;while(f=f.nextSibling);return 1},"nth-last-child":function(a,b){var c=a.nodeIndexLast||0,d=b[3]?(b[2]==="%"?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.lastChild;c++;do if(f.nodeType==1&&(f.nodeLastIndex=c++)&&a===f&&(c+d)%e)return 0;while(f=f.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return a.parentNode[ge+"sByTagName"]("*").length!=1},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&doc.documentElement.lang!==b},enabled:function(a){return a.disabled||a.type==="hidden"},disabled:function(a){return!a.disabled},selected:function(a){return child.parentNode.selectedIndex,!child.selected}}}),function(d,e){e&&(d=e+" "+d),e=doc;var f=[];if(d==="body *")return doc.body[ge+"sByTagName"]("*");if(/^[\w[:#.][\w\]*^|=!]*$/.test(d)){var g=0;switch(d.charAt(0)){case"#":g=d.slice(1),f=doc[ge+"ById"](g),pl.browser("ie")&&f.id!==g&&(f=doc.all[g]),f=f?[f]:[];break;case".":var h=d.slice(1);if(a)f=(g=(f=e[ge+"sByClassName"](h)).length)?f:[];else{h=" "+h+" ";var i=e[ge+"sByTagName"]("*"),j=0,k;while(k=i[j++])(" "+k[cn]+" ").indexOf(h)!=-1&&(f[g++]=k);f=g?f:[]}break;case":":var k,i=e[ge+"sByTagName"]("*"),j=0,l=d.replace(/[^(]*\(([^)]*)\)/,"$1"),m=d.replace(/\(.*/,"");while(k=i[j++])c.mods[m]&&!c.mods[m](k,l)&&(f[g++]=k);f=g?f:[];break;case"[":var i=e[ge+"sByTagName"]("*"),k,j=0,o=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/.exec(d),p=o[1],q=o[2]||"",r=o[3];while(k=i[j++])c.attr[q]&&(c.attr[q](k,p,r)||p==="class"&&c.attr[q](k,cn,r))&&(f[g++]=k);f=g?f:[];break;default:f=(g=(f=e[ge+"sByTagName"](d)).length)?f:[]}}else if(b&&d.indexOf("!=")==-1)f=e.querySelectorAll(d.replace(/=([^\]]+)/,'="$1"'));else{var s=d.split(/ *, */),t=s.length-1,u=!!t,v,w,x,y,j,z,i,A,B,h,p,q,m,l,C,g,D,E,F,G,H,I;while(v=s[t--]){x=(w=v.replace(/(\([^)]*)\+/,"$1%").replace(/(\[[^\]]+)~/,"$1&").replace(/(~|>|\+)/," $1 ").split(/ +/)).length,j=0,z=" ",i=[e];while(y=w[j++])if(y!==" "&&y!==">"&&y!=="~"&&y!=="+"&&i){y=y.match(/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?:\:([^(]+)(?:\(([^)]+)\))?)?/),A=y[1]||"*",B=y[2],h=y[3]?" "+y[3]+" ":"",p=y[4],q=y[5]||"",m=y[7],l=m==="nth-child"||m==="nth-last-child"?/(?:(-?\d*)n)?(?:(%|-)(\d*))?/.exec(y[8]==="even"&&"2n"||y[8]==="odd"&&"2n%1"||!/\D/.test(y[8])&&"0n%"+y[8]||y[8]):y[8],C=[],g=D=0,F=j==x;while(E=i[D++])switch(z){case" ":G=E[ge+"sByTagName"](A),I=0;while(H=G[I++])(!B||H.id===B)&&(!h||(" "+H[cn]+" ").indexOf(h)!=-1)&&(!p||c.attr[q]&&(c.attr[q](H,p,y[6])||p==="class"&&c.attr[q](H,cn,y[6])))&&!H.yeasss&&(c.mods[m]?!c.mods[m](H,l):!m)&&(F&&(H.yeasss=1),C[g++]=H);break;case"~":A=A.toLowerCase();while((E=E.nextSibling)&&!E.yeasss)E.nodeType==1&&(A==="*"||E.nodeName.toLowerCase()===A)&&(!B||E.id===B)&&(!h||(" "+E[cn]+" ").indexOf(h)!=-1)&&(!p||c.attr[q]&&(c.attr[q](H,p,y[6])||p==="class"&&c.attr[q](H,cn,y[6])))&&!E.yeasss&&(c.mods[m]?!c.mods[m](E,l):!m)&&(F&&(E.yeasss=1),C[g++]=E);break;case"+":while((E=E.nextSibling)&&E.nodeType!=1);E&&(E.nodeName.toLowerCase()===A.toLowerCase()||A==="*")&&(!B||E.id===B)&&(!h||(" "+H[cn]+" ").indexOf(h)!=-1)&&(!p||c.attr[q]&&(c.attr[q](H,p,y[6])||p==="class"&&c.attr[q](H,cn,y[6])))&&!E.yeasss&&(c.mods[m]?!c.mods[m](E,l):!m)&&(F&&(E.yeasss=1),C[g++]=E);break;case">":G=E[ge+"sByTagName"](A),j=0;while(H=G[j++])H.parentNode===E&&(!B||H.id===B)&&(!h||(" "+H[cn]+" ").indexOf(h)!=-1)&&(!p||c.attr[q]&&(c.attr[q](H,p,y[6])||p==="class"&&c.attr[q](H,cn,y[6])))&&!H.yeasss&&(c.mods[m]?!c.mods[m](H,l):!m)&&(F&&(H.yeasss=1),C[g++]=H)}i=C}else z=y;if(u){if(!i.concat){C=[],I=0;while(H=i[I])C[I++]=H;i=C}f=i.concat(f.length==1?f[0]:f)}else f=i}g=f.length;while(g--)f[g].yeasss=f[g].nodeIndex=f[g].nodeIndexLast=n}return f}}({})})}()})(this,document,"prototype","addEventListener","getElement","className","null","undef","<([A-z]+)>",null,function(){})