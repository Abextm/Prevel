/* Prevel Framework v1.0.8
 * http://github.com/chernikovalexey/Prevel
 * 
 * Copyright 2011, Alexey Chernikov
 * Dual licensed under the:
 *  - GNU LGPL (http://opensource.org/licenses/lgpl-license.php)
 *  - MIT License (http://opensource.org/licenses/mit-license.php)
 * 
 * =====
 * 
 * Contains YASS v0.3.9
 * http://yass.webo.in
 * 
 * Copyright 2008-2009, Nikolay Matsievsky (sunnybear)
 * Dual licensed under the:
 *  - MIT License (http://opensource.org/licenses/mit-license.php)
 *  - GNU GPL (http://opensource.org/licenses/gpl-license.php)
**/
(function(q,f,v,B,p,o,D,z,H,A,C,I){(function(){var f={"function":"fn",object:"obj",number:"int",string:"str","boolean":"bool",undefined:z},m=!!Object[v].__lookupGetter__&&!!Object[v].__lookupSetter__&&!!Object[v].__defineGetter__&&!!Object[v].__defineSetter,e=function(){return function(d,c,b){return e.fn?new e.fn.init(d,c,b):I}}(),b=q.navigator.userAgent.toLowerCase();e.extend=function(d,c){c||(c=d,d=e);if(m){var b,g,a;for(a in c)b=c.__lookupGetter__(a),g=c.__lookupSetter__(a),b||g?(b&&d.__defineGetter__(a, b),g&&d.__defineSetter__(a,g)):d[a]||(d[a]=c[a])}else for(a in c)d[a]||(d[a]=c[a]);return d};e.extend({implement:function(d,c){return e.extend(d[v],c)},isArray:Array.isArray||function(d){return Object[v].toString.call(d)==="[object Array]"},type:function(d,c){var b=e.isArray(d)?"arr":d instanceof RegExp?"regexp":d instanceof Date?"date":d===A?D:f[typeof d];return c?b===c:b},empty:function(d){if(e.type(d,"obj")){for(var c in d)return false;return true}return e.type(d,D)||e.type(d,z)||!d.length},trim:function(d){return"".trim? d.trim():d.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},each:function(d,c){for(var b=d.length;--b>-1;)c.call(d[b],b,d[b])},inArray:function(b,c){return[].indexOf?c.indexOf(b):(e.each(c,function(c){if(b===this)return c}),-1)},toParams:function(b){if(!e.type(b,"obj"))return b;var c=[],k;for(k in b)c.push(encodeURIComponent(k)+"="+encodeURIComponent(b[k]));return c.join("&")},JSON:function(b){return q.JSON&&q.JSON.parse?q.JSON.parse(b):!/[^,:{}[]0-9.-+Eaeflnr-u nrt]/.test(b.replace(/"(.|[^"])*"/g,""))&& eval("("+b+")")},browser:function(d){var c=/opera/i.test(b),e=/chrome/i.test(b),c={opera:c,ie:!c&&/msie/i.test(b),ie6:!c&&/msie 6/i.test(b),ie7:!c&&/msie 7/i.test(b),ie8:!c&&/msie 8/i.test(b),firefox:/firefox/i.test(b),chrome:e,safari_khtml:!e&&/khtml/i.test(b),safari:!e&&/webkit|safari/i.test(b)},g;for(g in c)if(c[g])return d?d===g:g}});q.pl=e})();(function(){pl.extend({ajax:function(f){var m,e=f.load||C,b=f.error||C,d=f.success||C,c=function(b){m.setRequestHeader("X-Requested-With","XMLHttpRequest"); b&&m.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset="+(f.charset||"utf-8"))};f.type=f.type||"POST";f.data=pl.toParams(f.data||{});f.async=f.async||true;(function(){if(q.XMLHttpRequest)m=new XMLHttpRequest,m.overrideMimeType&&m.overrideMimeType("text/html");else if(q.ActiveXObject)try{m=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{m=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){}}if(!m)return alert("Could not create a XMLHttpRequest instance.");m.onreadystatechange= function(){switch(m.readyState){case 1:e();break;case 4:m.status===200?d(f.dataType==="json"?pl.JSON(m.responseText):m.responseText):b(m.status)}}})();switch(f.type){case "POST":m.open("POST",f.url,f.async);c(1);m.send(f.data);break;case "GET":m.open("GET",f.url+"?"+f.data,f.async),c(),m.send(A)}}})})();(function(){var p,m={className:"class",cssFloat:"float",htmlFor:"for"};pl.extend({fn:{},find:function(a,b){return f.querySelectorAll(b?b+" "+a:a)}});pl.extend(pl.fn,{init:function(){return function(a, c,d){var n;switch(pl.type(a)){case "str":var h=a.match(H);if(h)n=c,h=f.createElement(h[1]),n=[n?pl(h).attr(n).get():h];else switch(pl.type(c)){case "str":switch(pl.type(d)){case "int":n=[pl.find(a,c)[d]];break;default:case z:n=pl.find(a)}break;case "int":n=[pl.find(a)[c]];break;default:case z:n=pl.find(a)}break;case "fn":b.ready(a);break;case "obj":n=a[0]?a:[a]}return this.elements=n,this.selector=arguments,p=this,this}}(),len:function(){return this.elements.length},last:function(){var a=this.elements.length; return this.elements=[a?this.elements[a-1]:A],this},html:function(a,b){return d(this,"innerHTML",a,b)},text:function(a,b){return d(this,e,a,b)},get:function(a){var b=this.elements;return b.length===1?b[0]:pl.type(a,z)?b:b[a]},parent:function(a){a||(a=1);return this.elements=[g(this.elements[0],a)],this},remove:function(){return pl.each(this.elements,function(){this.parentNode.removeChild(this)}),this},addClass:function(a){return pl.each(this.elements,function(){this[o]&&!~~pl.inArray(a,this[o].split(" "))&& (this[o]+=(this[o]?" ":"")+a)}),this},hasClass:function(a){return this.elements[0]&&this.elements[0][o]?~~pl.inArray(a,this.elements[0][o].split(" ")):false},removeClass:function(a){return pl.each(this.elements,function(){if(this[o]){var b=this[o].split(" "),c=pl.inArray(a,b);~~c||(b.splice(c,1),pl.empty(b)?this.removeAttribute("class"):this[o]=b.join(" "))}}),this},attr:function(a,b){a=m[a]||a;if(b)pl.each(this.elements,function(){this.setAttribute(a,b)});else switch(pl.type(a)){case "obj":for(var c in a)arguments.callee.call(this, c,a[c]);break;case "str":return this.elements[0].getAttribute(a)}return this},removeAttr:function(a){return a=m[a]||a,pl.each(this.elements,function(){this.removeAttribute(a)}),this},css:function(a,b){if(b){a=c.fixStyle(a);if(pl.type(b,"int")&&!c.rmvPostFix[a])b+="px";else if(a==="opacity")var d=c.fixOpacity(b),a=d[0],b=d[1];pl.each(this.elements,function(){this.style[a]=b})}else switch(pl.type(a)){case "obj":for(d in a)arguments.callee.call(this,d,a[d]);break;case "str":return c.get(this.elements[0], a)}return this},each:function(a){return pl.each(p.elements,function(){a.call(this)}),this},bind:function(a,c){return b.routeEvent(a,c,1)},unbind:function(a,c){return b.routeEvent(a,c,0)},show:function(){return pl.each(this.elements,function(){pl(this).css("display")==="none"&&pl(this).css("display",this.getAttribute("plrd")||"")}),this},hide:function(){return pl.each(this.elements,function(){var a=pl(this).css("display");if(a!=="none")this.setAttribute("plrd",a),this.style.display="none"}),this}, after:function(a){if(pl.type(a,"obj")){var b=f.createElement("div");b.appendChild(a);a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=f.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.parentNode.insertBefore(this,b.nextSibling)})}catch(d){}}),this},before:function(a){if(pl.type(a,"obj")){var b=f.createElement("div");b.appendChild(a);a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=f.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes, function(){b.parentNode.insertBefore(this,b)})}catch(d){}}),this},append:function(a){if(pl.type(a,"obj")){var b=f.createElement("div");b.appendChild(a);a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=f.createElement("div");c.innerHTML=a;try{pl.each(c.childNodes,function(){b.appendChild(this)})}catch(d){}}),this},prepend:function(a){if(pl.type(a,"obj")){var b=f.createElement("div");b.appendChild(a);a=b.innerHTML}return pl.each(this.elements,function(){var b=this,c=f.createElement("div"); c.innerHTML=a;try{pl.each(c.childNodes,function(){b.insertBefore(this,b.firstChild)})}catch(d){}}),this},appendTo:function(a,b,c){return pl(a,b,c).append(this.elements[0]),this},prependTo:function(a,b,c){return pl(a,b,c).prepend(this.elements[0]),this}});pl.implement(pl.fn.init,pl.fn);var e=pl.browser("ie")?"innerText":"textContent",b={ready:function(){this.readyList=[];this.bindReady=function(a){function c(){n||(n=true,a())}var n=false;if(f[B])b.attaches.bind(f,"DOMContentLoaded",c);else if(f.attachEvent){if(f.documentElement.doScroll&& q===q.top){var d=function(){if(!n&&f.body)try{f.documentElement.doScroll("left"),c()}catch(a){setTimeout(d,0)}};d()}b.attaches.bind(f,"readystatechange",function(){f.readyState==="complete"&&c()})}b.attaches.bind(q,"load",c)};var a=this;return function(b){a.readyList.length||a.bindReady(function(){pl.each(a.readyList,function(){this()})});a.readyList.push(b)}}(),attaches:function(){function a(a){a=a||q.event;if(a.fixed)return a;a.fixed=true;a.preventDefault=a.preventDefault||function(){this.returnValue= false};a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=true};a.target||(a.target=a.srcElement);if(a.pageX==A&&a.clientX!=A){var b=f.documentElement,c=f.body;a.pageX=a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b.clientTop||0)}return pl.type(a.which,"undef")&&!pl.type(a.button,"undef")&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0),a}function c(b){var b=a(b),d=this.evt[b.type],f;for(f in d)d[f].call(this, b)||(b.preventDefault(),b.stopPropagation())}var d=0;return{bind:function(a,e,g){if(a.setInterval&&!a.frameElement&&(a!==q&&(a=q),~~pl.inArray(e,k)))return window.onload=function(){pl(f.body).bind(e,g)};g.turnID||(g.turnID=++d);a.evt||(a.evt={},a.handleEvt=function(d){if(!pl.type(b.attaches,z))return c.call(a,d)});a.evt[e]||(a.evt[e]={},a[B]?a[B](e,a.handleEvt,false):a.attachEvent("on"+e,a.handleEvt));a.evt[e][g.turnID]=g},unbind:function(a,b,c){var d=a.evt&&a.evt[b];if(d){delete d[c.turnID];for(var e in d)return; a.removeEventListener?a.removeEventListener(b,a.handleEvt,false):a.detachEvent("on"+b,a.handleEvt);delete a.evt[b];for(e in a.evt)return;try{delete a.handleEvt,delete a.evt}catch(f){a.removeAttribute("handleEvt"),a.removeAttribute("evt")}}}}}(),routeEvent:function(a,c,d){if(c)d?pl.each(p.elements,function(){b.attaches.bind(this,a,c)}):pl.each(p.elements,function(){b.attaches.unbind(this,a,c)});else for(var e in a)arguments.callee(e,a[e],d);return p}},d=function(a,b,c,d){var e=a,a=e.elements[0];if(!c)return a[b]; if(d)switch(d){case 1:pl.each(e.elements,function(){this[b]+=c});break;case -1:pl.each(e.elements,function(){this[b]=c+this[b]})}else a[b]=c;return e},c={fixStyle:function(a){if(!a.match("-"))return a;a=a.split("-");return a[0]+a[1].charAt(0).toUpperCase()+a[1].substr(1)},fixOpacity:function(a){var b=["opacity",a];switch(pl.browser()){case "ie7":b[0]="filter";b[1]="alpha(opacity="+a*100+");";break;case "ie8":b[0]="-ms-filter";b[1]="alpha(opacity="+a*100+")";break;case "safari_khtml":b[0]="-khtml-opacity"; break;case "firefox":b[0]="-moz-opacity"}return b},fixReturnOpacity:function(a){return a?a.match("opacity=")?a.match("=([0-9]+)")[1]/100:a:A},rmvPostFix:{zIndex:true,fontWeight:true,opacity:true,zoom:true,lineHeight:true},get:function(a,b){b==="opacity"&&(b=c.fixOpacity(0)[0]);return c.fixReturnOpacity(a.currentStyle?a.currentStyle[b]:q.getComputedStyle(a,A).getPropertyValue(b))}},k="click,mouseover,mouseout,keyup,keydown,dblclick,mousedown,mouseup,keypress".split(","),g=function(a,b){return b>0? g(a.parentNode,--b):a}})();(function(){var q=!!f[p+"sByClassName"],m=!!f.querySelectorAll;pl.find=function(e){return pl.extend(e,{attr:{"":function(b,d){return!!b.getAttribute(d)},"=":function(b,d,c){return(d=b.getAttribute(d))&&d===c},"&=":function(){},"^=":function(){},"$=":function(){},"*=":function(){},"|=":function(){},"!=":function(){}},mods:{"first-child":function(b){return b.parentNode.getElementsByTagName("*")[0]!==b},"last-child":function(b){for(;(b=b.nextSibling)&&b.nodeType!=1;);return!!b}, root:function(b){return b.nodeName.toLowerCase()!=="html"},"nth-child":function(b,d){var c=b.nodeIndex||0,e=d[3]=d[3]?(d[2]==="%"?-1:1)*d[3]:0,f=d[1];if(c)return!((c+e)%f);var a=b.parentNode.firstChild;c++;do if(a.nodeType==1&&(a.nodeIndex=++c)&&b===a&&(c+e)%f)return 0;while(a=a.nextSibling);return 1},"nth-last-child":function(b,d){var c=b.nodeIndexLast||0,e=d[3]?(d[2]==="%"?-1:1)*d[3]:0,f=d[1];if(c)return!((c+e)%f);var a=b.parentNode.lastChild;c++;do if(a.nodeType==1&&(a.nodeLastIndex=c++)&&b=== a&&(c+e)%f)return 0;while(a=a.previousSibling);return 1},empty:function(b){return!!b.firstChild},parent:function(b){return!b.firstChild},"only-child":function(b){return b.parentNode[p+"sByTagName"]("*").length!=1},checked:function(b){return!b.checked},lang:function(b,d){return b.lang!==d&&f.documentElement.lang!==d},enabled:function(b){return b.disabled||b.type==="hidden"},disabled:function(b){return!b.disabled},selected:function(){return!child.selected}}}),function(b,d){d&&(b=d+" "+b);d=f;var c= [];if(b==="body *")return f.body[p+"sByTagName"]("*");if(/^[\w[:#.][\w\]*^|=!]*$/.test(b)){var k=0;switch(b.charAt(0)){case "#":k=b.slice(1);c=f[p+"ById"](k);pl.browser("ie")&&c.id!==k&&(c=f.all[k]);c=c?[c]:[];break;case ".":var g=b.slice(1);if(q)c=(c=d[p+"sByClassName"](g)).length?c:[];else{for(var g=" "+g+" ",a=d[p+"sByTagName"]("*"),u=0,t;t=a[u++];)(" "+t[o]+" ").indexOf(g)!=-1&&(c[k++]=t);c=k?c:[]}break;case ":":for(var a=d[p+"sByTagName"]("*"),u=0,n=b.replace(/[^(]*\(([^)]*)\)/,"$1"),h=b.replace(/\(.*/, "");t=a[u++];)e.mods[h]&&!e.mods[h](t,n)&&(c[k++]=t);c=k?c:[];break;case "[":for(var a=d[p+"sByTagName"]("*"),u=0,h=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/.exec(b),s=h[1],r=h[2]||"",h=h[3];t=a[u++];)e.attr[r]&&(e.attr[r](t,s,h)||s==="class"&&e.attr[r](t,o,h))&&(c[k++]=t);c=k?c:[];break;default:c=(c=d[p+"sByTagName"](b)).length?c:[]}}else if(m&&b.indexOf("!=")==-1)c=d.querySelectorAll(b.replace(/=([^\]]+)/,'="$1"'));else{t=b.split(/ *, */);for(var v=t.length-1,z=!!v,B,C,j,G,w,x,y,D,i,E,F,l;k= t[v--];){for(C=(B=k.replace(/(\([^)]*)\+/,"$1%").replace(/(\[[^\]]+)~/,"$1&").replace(/(~|>|\+)/," $1 ").split(/ +/)).length,u=0,G=" ",a=[d];j=B[u++];)if(j!==" "&&j!==">"&&j!=="~"&&j!=="+"&&a){for(j=j.match(/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?:\:([^(]+)(?:\(([^)]+)\))?)?/),w=j[1]||"*",x=j[2],g=j[3]?" "+j[3]+" ":"",s=j[4],r=j[5]||"",h=j[7],n=h==="nth-child"||h==="nth-last-child"?/(?:(-?\d*)n)?(?:(%|-)(\d*))?/.exec(j[8]==="even"&&"2n"||j[8]=== "odd"&&"2n%1"||!/\D/.test(j[8])&&"0n%"+j[8]||j[8]):j[8],y=[],k=D=0,E=u==C;i=a[D++];)switch(G){case " ":for(F=i[p+"sByTagName"](w),i=0;l=F[i++];)(!x||l.id===x)&&(!g||(" "+l[o]+" ").indexOf(g)!=-1)&&(!s||e.attr[r]&&(e.attr[r](l,s,j[6])||s==="class"&&e.attr[r](l,o,j[6])))&&!l.yeasss&&(e.mods[h]?!e.mods[h](l,n):!h)&&(E&&(l.yeasss=1),y[k++]=l);break;case "~":for(w=w.toLowerCase();(i=i.nextSibling)&&!i.yeasss;)i.nodeType==1&&(w==="*"||i.nodeName.toLowerCase()===w)&&(!x||i.id===x)&&(!g||(" "+i[o]+" ").indexOf(g)!= -1)&&(!s||e.attr[r]&&(e.attr[r](l,s,j[6])||s==="class"&&e.attr[r](l,o,j[6])))&&!i.yeasss&&(e.mods[h]?!e.mods[h](i,n):!h)&&(E&&(i.yeasss=1),y[k++]=i);break;case "+":for(;(i=i.nextSibling)&&i.nodeType!=1;);i&&(i.nodeName.toLowerCase()===w.toLowerCase()||w==="*")&&(!x||i.id===x)&&(!g||(" "+l[o]+" ").indexOf(g)!=-1)&&(!s||e.attr[r]&&(e.attr[r](l,s,j[6])||s==="class"&&e.attr[r](l,o,j[6])))&&!i.yeasss&&(e.mods[h]?!e.mods[h](i,n):!h)&&(E&&(i.yeasss=1),y[k++]=i);break;case ">":for(F=i[p+"sByTagName"](w), u=0;l=F[u++];)l.parentNode===i&&(!x||l.id===x)&&(!g||(" "+l[o]+" ").indexOf(g)!=-1)&&(!s||e.attr[r]&&(e.attr[r](l,s,j[6])||s==="class"&&e.attr[r](l,o,j[6])))&&!l.yeasss&&(e.mods[h]?!e.mods[h](l,n):!h)&&(E&&(l.yeasss=1),y[k++]=l)}a=y}else G=j;if(z){if(!a.concat){for(y=[],i=0;l=a[i];)y[i++]=l;a=y}c=a.concat(c.length==1?c[0]:c)}else c=a}for(k=c.length;k--;)c[k].yeasss=c[k].nodeIndex=c[k].nodeIndexLast=A}return c}}({})})()})(this,document,"prototype","addEventListener","getElement","className","null", "undef","<([A-z]+)>",null,function(){});